# Гибридная система управления температурой

Проект представляет собой реализацию гибридной системы управления температурой, объединяющей классический ПИД-регулятор и нейронную сеть LSTM. Система разработана для эффективного управления охлаждением помещения.

## Структура проекта

```
pid-ai/
├── main.py           # Реализация ПИД-регулятора и симуляции помещения
├── train_nn.py          # Обучение нейронной сети LSTM
├── hybrid_controller.py # Гибридный регулятор (ПИД + LSTM)
├── model.pth           # Обученная модель LSTM
└── scaler_params.json  # Параметры нормализации данных
```

## Компоненты системы

### 1. ПИД-регулятор (`main.py`)
- Реализация классического ПИД-регулятора
- Модель помещения с учетом тепловой инерции
- Сбор данных для обучения нейронной сети
- Параметры регулятора:
  - Kp = 2.0 (пропорциональный коэффициент)
  - Ki = 0.05 (интегральный коэффициент)
  - Kd = 1.0 (дифференциальный коэффициент)

### 2. Нейронная сеть (`train_nn.py`)
- Архитектура: LSTM (Long Short-Term Memory)
- Структура сети:
  - Входной слой: 5 признаков
  - LSTM слои: 2 слоя, 64 нейрона
  - Полносвязные слои: 64 → 32 → 1
  - Функция активации выходного слоя: Sigmoid
- Параметры обучения:
  - Размер последовательности: 10
  - Размер батча: 32
  - Количество эпох: 100
  - Скорость обучения: 0.001

### 3. Гибридный регулятор (`hybrid_controller.py`)
- Объединяет ПИД-регулятор и LSTM
- Параметр смешивания α (alpha):
  - α = 0: только ПИД-регулятор
  - α = 1: только нейронная сеть
  - α = 0.5: равное влияние обоих компонентов

## Установка и запуск

1. Создайте виртуальное окружение и установите зависимости:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
pip install -r requirements.txt
```

2. Запустите симуляцию с ПИД-регулятором для сбора данных:
```bash
python main.py
```

3. Обучите нейронную сеть на собранных данных:
```bash
python train_nn.py
```

4. Запустите симуляцию с гибридным регулятором:
```bash
python hybrid_controller.py
```

## Результаты

Система демонстрирует следующие характеристики:
- Плавное управление температурой
- Отсутствие перерегулирования
- Стабильная работа в различных режимах
- Адаптивность благодаря нейронной сети

## Графики и визуализация

- `training_results.png` - процесс обучения нейронной сети
- `hybrid_simulation_results.png` - результаты работы гибридного регулятора
  - Верхний график: изменение температуры
  - Нижний график: управляющий сигнал

## Дальнейшие улучшения

1. Оптимизация гиперпараметров нейронной сети
2. Реализация адаптивного коэффициента смешивания α
3. Добавление обработки внешних возмущений
4. Реализация онлайн-обучения нейронной сети

## Примечания

- Система разработана для учебных и исследовательских целей
- Все параметры могут быть настроены под конкретную задачу
- Рекомендуется экспериментировать с различными значениями α для оптимальной работы